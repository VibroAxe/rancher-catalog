version: '2'
services:
  monocache:
    image: steamcache/monolithic:latest
    ports:
        - ${CACHE_IP}:80:80
    environment:
      CACHE_MONOLITHIC: true
      CACHE_DISK_SIZE: ${CACHE_DISK_SIZE}m
      CACHE_MEM_SIZE: ${CACHE_MEM_SIZE}m
      CACHE_MAX_AGE: ${CACHE_MAX_AGE}d
    volumes:
      - ${CACHE_ROOT}/cache:/data/cache
      - ${CACHE_ROOT}/logs:/data/logs
      - ${CACHE_ROOT}/cachedomains:/data/cachedomains
  sniproxy:
    image: steamcache/sniproxy:latest
    ports:
        - 443:443/tcp
  dns:
    image: steamcache/steamcache-dns:latest
    ports:
      - 53:53/udp
    environment:
      USE_GENERIC_CACHE: false
      UPSTREAM_DNS: ${UPSTREAM_DNS}
